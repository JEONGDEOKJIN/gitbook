# íŠ¸ëŸ¬í”Œ(truffle) í™˜ê²½ì—ì„œ ì»¨íŠ¸ë™íŠ¸ ë°°í¬ í•˜ê¸°

## TOC

1. 1ï¸âƒ£ ì„¤ì¹˜ ë° í™˜ê²½ ì„¤ì •
2. 2ï¸âƒ£ ì»´íŒŒì¼
   1. 1\) ì†”ë¦¬ë””í‹° ì½”ë“œ ì‘ì„±
   2. 2\) ì»´íŒŒì¼ ëª…ë ¹ì–´ ì‘ì„±
3. 3ï¸âƒ£ ë°°í¬ (migration, deploy)
   1. 1\) ì–´ë–¤ ë„¤íŠ¸ì›Œí¬ì— ë°°í¬? ğŸ‘‰ ganache ë¡œ ë°°í¬! ğŸ‘‰ so, ganach ì„¤ì¹˜ ë° ì‹¤í–‰
   2. 2\) 'ì»´íŒŒì¼ëœ íŒŒì¼' ì„ ê°€ì ¸ì™€ì„œ, ë°°í¬(deploy) ì¤€ë¹„
   3. 3\) 'npx truffle migrate' ë¡œ ì‹¤ì œ ë°°í¬(migration, deploy) í•˜ê¸°
   4. 4\) ë°°í¬í•œ CA ì£¼ì†Œ ì €ì¥ í•´ë‘ê¸°
4. 4ï¸âƒ£ ë°°í¬ëœ ì»¨íŠ¸ë™íŠ¸ì— ì ‘ê·¼
   1. 1\) truffle ì½˜ì†” ì‚¬ìš©
5. 5ï¸âƒ£ í…ŒìŠ¤íŠ¸ ì½”ë“œ ì‘ì„±
   1. 1\) í…ŒìŠ¤íŠ¸ ì½”ë“œ ì‘ì„±
   2. 2\) í…ŒìŠ¤íŠ¸ ì½”ë“œ ì‹¤í–‰
6. 6ï¸âƒ£ í…ŒìŠ¤íŠ¸ ì½”ë“œ ì‘ì„±
   1. 1\) ë°°í¬í•œ ì»¨íŠ¸ë™íŠ¸ ë‚´ìš© ì¡°íšŒ
   2. 2\) getValue ê°’ ê°€ì ¸ì˜¤ê¸°
   3. 3\) setValue ë¡œ ê°’ ë³€ê²½í•˜ê³ , getValue ë¡œ ê°’ ê°€ì ¸ì˜¤ê¸°
7. 7ï¸âƒ£ react hook ìœ¼ë¡œ ì¦ê° ë²„íŠ¼ ëˆ„ë¥´ë©´, ìƒíƒœë³€ìˆ˜ ë³€ê²½ ë° ì¡°íšŒ êµ¬í˜„
   1. 1\) react ê¸°ë³¸ ì„¤ì •
   2. 2\) hooks, abi í´ë” ë° íŒŒì¼ ë§Œë“¤ê¸°
   3. 3\) ì»´íŒŒì¼ ì™„ë£Œëœ Counter.json ì—ì„œ abi í‚¤ì˜ ê°’ë§Œ ê°€ì ¸ì™€ì„œ ë¶™ì—¬ë„£ê¸°
   4. 4\) hook ì½”ë“œ ì‘ì„±
   5. 5\) react app.js ì½”ë“œ ì‘ì„±
8. 8ï¸âƒ£ ì‹¤í–‰í•´ë³´ê¸° | #checksheet
9. ğŸ¤¯ ë””ë²„ê¹…
   1. ë¬¸ì œ ìƒí™©
10. ğŸ”® ê¶ê¸ˆì¦

\


## truffle ì´í•´

* truffle ê°œë…

```bash
- ë°°í¬ë¥¼ í¸í•˜ê²Œ í•´ì£¼ëŠ” 'í”„ë ˆì„ì›Œí¬'(í´ë” êµ¬ì„±ì´ í¬í•¨ë˜ì–´ ìˆìŒ.)
- Dapps ê°œë°œì„ ì‰½ê²Œ í•  ìˆ˜ ìˆë„ë¡, ë„ì™€ì£¼ëŠ”, í”„ë ˆì„ì›Œí¬
- ë°°í¬ë¥¼ í¸í•˜ê²Œ í•  ìˆ˜ ìˆìŒ! 
- ìŠ¤ë§ˆíŠ¸ ì»¨íŠ¸ë™íŠ¸ ì»´íŒŒì¼, ë°°í¬ ë° í…ŒìŠ¤íŠ¸ ê¸°ëŠ¥ì„ ì‰½ê²Œ í•  ìˆ˜ ìˆë„ë¡ ë„ì™€ì¤€ë‹¤. 
```

* truffle êµ¬ì¡°

```bash
íŠ¸ëŸ¬í”Œ ì‚¬ìš© ì´ˆê¸° ë‹¨ê³„ 
	íŠ¸ëŸ¬í”Œì€ í”„ë ˆì„ì›Œí¬ ì´ê¸° ë•Œë¬¸ì—, 'init í•˜ë©´ -> í´ë” êµ¬ì¡° 3ê°œ' ë¥¼ ë§Œë“¤ì–´ì¤€ë‹¤. 
	
ìƒì„±ë˜ëŠ” í´ë” 
	1) constract 
		- ì†”ë¦¬ë””í‹° ì½”ë“œë¥¼ ì‘ì„±í•œ 'sol íŒŒì¼'ì„ ë‹´ì„ í´ë” 
		- 'ì»´íŒŒì¼' ëª…ë ¹ì„ ë‚´ë¦¬ë©´, 'contract í´ë”'ì— ìˆëŠ” 'sol íŒŒì¼' ì„ ì½ì–´ì„œ, 'ì»´íŒŒì¼' ì„ ì§„í–‰. 
		- ê·¸ëŸ¬ë©´, build í´ë”ê°€ ìƒê¸°ê³ , ì»´íŒŒì¼ëœ ë‚´ìš©ì´, json íŒŒì¼ë¡œ ìƒì„±ë¨. 
	
	2) migrations 
		- 'ìŠ¤ë§ˆíŠ¸ ì»¨íŠ¸ë™íŠ¸' ë¥¼ 'ì´ë”ë¦¬ì›€ ë„¤íŠ¸ì›Œí¬' ì— ë°°í¬í•˜ëŠ” ê³¼ì • (â“â“â“)
		- ì»¨íŠ¸ë™íŠ¸ ì½”ë“œë¥¼ ì§„í–‰í•  js ì½”ë“œ ì‘ì„± 
		- ì´ë”ë¦¬ì›€ ë„¤íŠ¸ì›Œí¬ì— ë°°í¬í•˜ëŠ” ë‚´ìš©ì„ ì‘ì„±í•  js ë¥¼ ì´ í´ë”ì— 

	3) test 
		- í…ŒìŠ¤íŠ¸ íŒŒì¼ 
```

\


## sol íŒŒì¼ ì˜ˆì‹œ

```js
// SPDX-License-Identifier: MIT
pragma solidity ^0.8.13;

contract Counter {
    // ìƒíƒœ ë³€ìˆ˜ 
    uint256 private value;
        // [uint256]
            // ì˜ë¯¸ : unsigned int, ë¶€ë“±í˜¸ê°€ ì—†ëŠ” ì •ìˆ˜, ë§ˆì´ë„ˆìŠ¤ë¡œ ë–¨ì–´ì§ˆ ìˆ˜ ì—†ëŠ” ì •ìˆ˜
            // í•„ìš”ì„± : ë°”ì´íŠ¸ë¥¼ ë‚­ë¹„í•˜ì§€ ì•Šê¸° ìœ„í•´ ì‘ì„±

    // ì§€ê°‘ì˜ ì£¼ì†Œ
    address sender = 0x0123456789012345678901234567890123456789;
        // address íƒ€ì… 
            // [íŠ¹ì§•] ca ë¥¼ ë‹´ì„ ìˆ˜ ìˆìŒ. -> so, 40ìë¦¬ê°€ ì™€ì•¼ í•¨. 
            // [íŠ¹ì§•] ì§€ê°‘ì£¼ì†Œë¥¼ ë§Œë“¤ ë•Œ ë´¤ìŒ 
            // [íŠ¹ì§•] address íƒ€ì…ìœ¼ë¡œ ë³€ìˆ˜ë¥¼ ë§Œë“¤ ê²½ìš°, ë‚´ë¶€ ì¸ìŠ¤í„´ìŠ¤ê°€ ìˆì–´ì„œ, ë‚´ë¶€ ë©”ì†Œë“œë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìŒ.  
                // ex) sender.balance : í•´ë‹¹ ì£¼ì†Œì˜ ì´ë” ì”ì•¡ ì¡°íšŒ ê°€ëŠ¥ 
                // ex) sender.transfer("ë³´ë‚¼ê¸ˆì•¡") : ì´ ì§€ê°‘ì—, ì–¼ë§ˆë¥¼ ì „ì†¡í•´~ ë¼ëŠ” ì˜ë¯¸ | ì‹¤íŒ¨ì‹œ 'ì˜ˆì™¸' ë¥¼ ë°œìƒì‹œí‚´ 
                // ex) sender.send("ë³´ë‚¼ê¸ˆì•¡") : ì´ ì§€ê°‘ì—, ì–¼ë§ˆë¥¼ ì „ì†¡í•´~ ë¼ëŠ” ì˜ë¯¸ | ì„±ê³µì‹œ true, ì‹¤íŒ¨ì‹œ false

    constructor() {}

    function setValue( uint256 _value ) public {
        value = _value;
    }
        /*  [í•´ì„]
            - ë‚´ìš© ë³€ê²½ì´ë‹ˆê¹Œ -> ê°€ìŠ¤ë¹„ ë°œìƒ 
            - 'ì›ê²© í”„ë¡œì‹œì € í˜¸ì¶œ' ì—ì„œ send ë¡œ ë³´ë‚¸ë‹¤. 
                - ìŠ¤ë§ˆíŠ¸ ì»¨íŠ¸ë™íŠ¸ í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•  ë•Œ, ì´ë”ë¦¬ì›€ ë„¤íŠ¸ì›Œí¬ì— íŠ¸ëœì­ì…˜ì„ ì „ì†¡í•˜ë ¤ë©´, send ë‚˜ sendTransaction ë©”ì†Œë“œë¥¼ ì‚¬ìš© 
                - ì—¬ê¸°ì—ì„œ send ëŠ” ì´ë”ë¦¬ì›€ ë„¤íŠ¸ì›Œí¬ì—, íŠ¸ëœì­ì…˜ì„ ì „ì†¡í•˜ëŠ” ë©”ì†Œë“œë¡œ ì‚¬ìš©ëœê±´ê°€? 
                - ê·¸ëŸ¬ë©´, ì´ setValue ë¥¼ send ë¡œ ë³´ë‚´ì£¼ëŠ” ê³¼ì •ì´ ìˆëŠ” ê±´ê°€? â“â“â“â“â“â“ 
            - public ì ‘ê·¼ì : ì–´ë””ì„œë‚˜ ì ‘ê·¼ ê°€ëŠ¥
        */

    function getValue( ) public view returns (uint256) {
        return value;
    }
        // view : ìƒíƒœ ë³€ìˆ˜ ë³€ê²½í•˜ì§€ ì•Šê³  ì½ê¸° ì „ìš©! 

}
```

## dev

### 1ï¸âƒ£ ì„¤ì¹˜ ë° í™˜ê²½ ì„¤ì •

```bash
# ë¦¬ì•¡íŠ¸ ì„¤ì¹˜
npx create-react-app dj_test
	# 	íŠ¸ëŸ¬í”Œì— ë¦¬ì•¡íŠ¸ëŠ” í•„ìˆ˜ê°€ ì•„ë‹˜ (ë‹¤ë§Œ, ì§€ê¸ˆ ë¦¬ì•¡íŠ¸ë¥¼ ì“°ê¸° ìœ„í•´ì„œì„!)

# ë°©ê¸ˆ ë§Œë“  í´ë”ë¡œ ì´ë™ 
cd dj_test

# ë¦¬ì•¡íŠ¸ ì„¤ì¹˜í•œ í´ë”ì— truffle ì„¤ì¹˜ (âœ… ë¦¬ì•¡íŠ¸ í´ë”ì— íŠ¸ëŸ¬í”Œì„ ì„¤ì¹˜í•´ì•¼ í•˜ëŠ” ê±´ ì•„ë‹ˆì§€ë§Œ, ì´ë²ˆì—ëŠ” ì´ë ‡ê²Œ ì§„í–‰)
npm i truffle

# íŠ¸ëŸ¬í”Œ ì´ˆê¸° ì…‹íŒ… 
npx truffle init

# truffle-config.js íŒŒì¼ ìˆ˜ì •
	# í™˜ê²½ ì„¤ì • | ì´ê±¸ ë³µì‚¬í•´ì„œ -> truffle-config.js ë¡œ ë¶™ì—¬ë„£ê¸°
	module.exports = {
	  networks: {
	    development: {
	      host: "127.0.0.1", // Localhost (default: none)
	      port: 8545, // Standard Ethereum port (default: none) | ê°€ë‚˜ì‰¬ í¬íŠ¸ âœ…
	      network_id: "*", // Any network (default: none)
	    },
	  },
	
	  compilers: {
	    solc: {
	      version: "0.8.13",     // ì†”ë¦¬ë””í‹° ë²„ì „âœ…
	    },
	  },
	};
```

### 2ï¸âƒ£ ì»´íŒŒì¼

#### 1) ì†”ë¦¬ë””í‹° ì½”ë“œ ì‘ì„±

```bash
- contract í´ë”ì— sol íŒŒì¼ ë§Œë“¤ê¸°
```

* sol íŒŒì¼ ì½”ë“œ

```solidity
// SPDX-License-Identifier: MIT
pragma solidity ^0.8.13;

contract Counter {
    // ìƒíƒœ ë³€ìˆ˜ 
    uint256 private value;
        // [uint256]
            // ì˜ë¯¸ : unsigned int, ë¶€ë“±í˜¸ê°€ ì—†ëŠ” ì •ìˆ˜, ë§ˆì´ë„ˆìŠ¤ë¡œ ë–¨ì–´ì§ˆ ìˆ˜ ì—†ëŠ” ì •ìˆ˜
            // í•„ìš”ì„± : ë°”ì´íŠ¸ë¥¼ ë‚­ë¹„í•˜ì§€ ì•Šê¸° ìœ„í•´ ì‘ì„±

    // ëˆ„ë¥´ë©´ 1 ì¦ê°€ 
    function increment() public {
        value += 1;
    }

    // ëˆ„ë¥´ë©´ 1 ê°ì†Œ 
    function decrement() public {
        value -= 1;
    } 

    // ê°’ ê°€ì ¸ì˜¤ê¸°
    function getValue( ) public view returns (uint256) {
        return value;
    }
        // view : ìƒíƒœ ë³€ìˆ˜ ë³€ê²½í•˜ì§€ ì•Šê³  ì½ê¸° ì „ìš©!
}

// ì™œ ì—¬ê¸°ì—ëŠ” 1) sender ì™€ 2) consturctor 3) setValue ê°€ ì—†ì§€?
// address sender = 0x0123456789012345678901234567890123456789;
// constructor() {}
```

#### 2) ì»´íŒŒì¼ ëª…ë ¹ì–´ ì‘ì„±

```bash
# truffle ì´ ì„¤ì¹˜ëœ dj_test ê²½ë¡œì—ì„œ ì‹¤í–‰í–ˆìŒ 
npx truffle compile

# ì‹¤í–‰ í›„, dj_test ë‚´ë¶€ì—, build í´ë”ê°€ ìƒê¹€ 
	# í•´ë‹¹ í´ë”ì—ëŠ” json í˜•ì‹ìœ¼ë¡œ ì €ì¥ë˜ì–´ ìˆê³  
	# build í´ë” ì•ˆì—, â­â­ abi ê°€ ìƒê¹€ 
	# network í‚¤ ì•ˆì—ëŠ” 'CA ê°€ ì €ì¥ ë  ì˜ˆì •â­â­'
```

*   abi : ì´ê±¸ í†µí•´ì„œ, ì´ì œ solidity ë¥¼ ì»¨íŠ¸ë¡¤ í•´ì„œ, ì´ë”ë¦¬ì›€ ì•ˆì— ìˆëŠ” ë©”ì„œë“œë¥¼ ì‹¤í–‰í•˜ê²Œ ë¨ (#ğŸ“› | ì¶”ê°€ë¡œ ì¢€ ë” í•™ìŠµ í•„ìš”)&#x20;

    <figure><img src="https://i.imgur.com/JP0u1Zm.png" alt=""><figcaption></figcaption></figure>
*   ca ê°€ ë“¤ì–´ê°ˆ networks&#x20;

    <figure><img src="https://i.imgur.com/Zrune0S.png" alt=""><figcaption></figcaption></figure>
*   â­â­â­ abi ì˜ 'ê°’' ë§Œ ê°€ì ¸ì™€ì•¼ í•¨&#x20;

    <figure><img src="https://i.imgur.com/K7jTDTF.png" alt=""><figcaption></figcaption></figure>

\


### 3ï¸âƒ£ ë°°í¬ (migration, deploy)

#### 1) ì–´ë–¤ ë„¤íŠ¸ì›Œí¬ì— ë°°í¬? ğŸ‘‰ ganache ë¡œ ë°°í¬! ğŸ‘‰ so, ganach ì„¤ì¹˜ ë° ì‹¤í–‰

```bash
# ganache ì„¤ì¹˜ 
	# ì„¤ì¹˜ ê²½ë¡œëŠ” dj_test! 
npm i ganache-cli 

# ganache ì‹¤í–‰
npx ganache-cli
```





#### 1.5) truffle í™˜ê²½ ì„¤ì • â­â­

```js
module.exports = {
  networks: {
    development: {
      host: "127.0.0.1", // Localhost (default: none)
      port: 8545, // Standard Ethereum port (default: none) | ê°€ë‚˜ì‰¬ í¬íŠ¸ âœ…
      network_id: "*", // Any network (default: none)
    },
  },

  compilers: {
    solc: {
      version: "0.8.13",     // ì†”ë¦¬ë””í‹° ë²„ì „âœ… | sol íŒŒì¼ì— ì íŒ ë²„ì „ê³¼ ë§ì•„ì•¼ í•¨
    },
  },
};
```

![](https://i.imgur.com/bzUlhTE.png)

#### 2) 'ì»´íŒŒì¼ëœ íŒŒì¼' ì„ ê°€ì ¸ì™€ì„œ, ë°°í¬(deploy) ì¤€ë¹„

* a) 'ë°°í¬ íŒŒì¼ ì´ë¦„' ì •í•˜ê¸°

```js
- íŒŒì¼ëª… : 'ë²ˆí˜¸(ìˆœì„œ)'_'ë‚´ìš©'_'ì»¨íŠ¸ë™íŠ¸ ì´ë¦„'.js íŒŒì¼ë¡œ ì´ë¦„ ì‘ì„±
ex) 1_deploy_Counter.js ì´ë ‡ê²Œ ì´ë¦„ì„ ì‘ì„±
```

![](https://i.imgur.com/saCYden.png)

* b) 'ì»´íŒŒì¼ëœ ê²°ê³¼ë¬¼' ê°€ì ¸ì˜¤ê³  í•˜ê³  ğŸ‘‰ ë°°í¬(deploy) í•˜ê¸°

```js
// 'ì»´íŒŒì¼ ëœ ê²°ê³¼ë¬¼' ê°€ì ¸ì˜¤ê¸°
const Counter = artifacts.require("Counter");
    // [í•„ìš”ì„±] 'ì»´íŒŒì¼ëœ ê²°ê³¼ë¬¼' ì„ 'ì´ë”ë¦¬ì›€ ë„¤íŠ¸ì›Œí¬' ì— ì˜¬ë¦´ ìˆ˜ ìˆë„ë¡ í•˜ê¸° ìœ„í•¨ 
    // [í•´ì„] 
        // artifacts : ì»´íŒŒì¼ëœ ê²°ê³¼ë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ìˆëŠ” truffle ì˜ ë¼ì´ë¸ŒëŸ¬ë¦¬ 
        // artifacts.require("Counter") : ì»´íŒŒì¼ ëœ ê²°ê³¼ ì¤‘, íŒŒì¼ ì´ë¦„ì´ Counter ì¸ ê²ƒì„ ê°€ì ¸ì˜¨ë‹¤. 

module.exports = (deployer) => {

    // Counter íŒŒì¼, ë°°í¬í•˜ê¸° 
    deployer.deploy(Counter)
        // [í•´ì„]
            // deployer : module.exports ì‹¤í–‰ì‹œ, Truffle ì— ì˜í•´ ì£¼ì… ëœë‹¤. 
            // deployer.deploy : ì´ë”ë¦¬ì›€ ë„¤íŠ¸ì›Œí¬ì— ì˜¬ë¼ê°€ê²Œ í•œë‹¤. 
            // Counter : 1) 'ì‘ì„±í•œ solidity' ê°€ 2) 'ì»´íŒŒì¼ëœ íŒŒì¼' ì„ 3) 'artifacts' ë¡œ ê°€ì ¸ì˜¨ íŒŒì¼
}
			// deploy ë§¤ê°œë³€ìˆ˜ = ë°°í¬í•  ìŠ¤ë§ˆíŠ¸ ì»¨íŠ¸ë™íŠ¸ = íŠ¸ëŸ¬í”Œ ì½˜ì†”ì—ì„œ ì´ ì´ë¦„ì„ ë¶ˆëŸ¬ì•¼ í•¨ â­â­â­â­â­

    // [í•´ì„]
        // ìµëª…í•¨ìˆ˜ì˜ ë§¤ê°œë³€ìˆ˜ì¸ deployer ëŠ” Truffle ì´ í•´ë‹¹ í•¨ìˆ˜ë¥¼ ì‹¤í–‰í•  ë•Œ, ìë™ì ìœ¼ë¡œ, ì±„ì›Œì¤€ë‹¤. 
    
    // [ë°°í¬ ì™„ë£Œ ë˜ë©´]
        // 1) 'ìŠ¤ë§ˆíŠ¸ ì»¨íŠ¸ë™íŠ¸ì˜ ë°”ì´íŠ¸ ì½”ë“œ' ê°€ 'ì´ë”ë¦¬ì›€ ë„¤íŠ¸ì›Œí¬' ì— ë°°í¬ â­â­â­â­â­â­
        // 2) ê·¸ ê²°ê³¼, í•´ë‹¹ ì»¨íŠ¸ë™íŠ¸ ì£¼ì†Œ(CA, contract address) ê°€ ìƒì„±ëœë‹¤.  â­â­â­â­â­â­
```

\


#### 3) 'npx truffle migrate' ë¡œ ì‹¤ì œ ë°°í¬(migration, deploy) í•˜ê¸°

```bash
# ì‹¤ì œ, ë°°í¬ ê°€ëŠ¥í•˜ê²Œ í•˜ëŠ” ëª…ë ¹ì–´
	# ê²½ë¡œëŠ” dj_test ì—ì„œ ì§„í–‰ | ê·¸ ì´ìœ ëŠ” truffle ì´ dj_test ì— ì„¤ì¹˜ ë˜ì–´ ìˆê¸° ë•Œë¬¸! 
npx truffle migrate
	# í˜„ì¬, ganache ë„¤íŠ¸ì›Œí¬ ì•ˆì— ìˆìœ¼ë¯€ë¡œ, ganache ì—ì„œ ë°°í¬ ì§„í–‰
```

![](https://i.imgur.com/x2VXx74.png)

\


#### 4) ë°°í¬í•œ CA ì£¼ì†Œ ì €ì¥ í•´ë‘ê¸°

```
0x3Dcbf3B1842038Df2C34afb9e2808592fC08801a
```

```BASH
ê·¸ëŸ¬ë©´, ì´ì œ 
	- â­â­ 'í•´ë‹¹ CA ì£¼ì†Œ'ë¡œ, ì´ë”ë¦¬ì›€ ë„¤íŠ¸ì›Œí¬ì— ì˜¬ë¼ê°€ ìˆëŠ” Counter.sol íŒŒì¼ì— ì ‘ê·¼í•´ì„œ, ìƒíƒœë³€ìˆ˜ê°’ì„ ê°€ì ¸ì˜¤ê±°ë‚˜, ìˆ˜ì •í•  ìˆ˜ ìˆìŒ. â­â­ 
	- ì´ ê³¼ì •ì—ì„œ 'CA ë¡œ ìš”ì²­ì„ ë³´ë‚´ì„œ, call ì´ë‚˜, send ë¥¼ í†µí•´, ì›ê²© í”„ë¡œì‹œì € ì‹¤í–‰ì„ í•  ìˆ˜ ìˆìŒ' ì´ë¼ëŠ” ê±´ ì–´ë–¤ ì˜ë¯¸ ì¼ê¹Œâ“â“â“ 
		- web3 ë¼ì´ë¸ŒëŸ¬ë¦¬ ì¤‘ í•˜ë‚˜ ì¸ call, send ë¥¼ ì‚¬ìš©í•´ì„œ, 'await contract.methods.getValue().call();' ì´ëŸ¬í•œ êµ¬ë¬¸ì„ í†µí•´, solidity ì— ì‘ì„± í•¨ìˆ˜ì¸ getValue( ) ì— ì ‘ê·¼í•  ìˆ˜ ìˆë‹¤ëŠ” ë§ ì„! 
```

\


### 4ï¸âƒ£ ë°°í¬ëœ ì»¨íŠ¸ë™íŠ¸ì— ì ‘ê·¼

* ì´ ê³¼ì •ì— ëŒ€í•œ ê¶ê¸ˆì¦

```
- ì§€ê¸ˆ ì´ ìˆœê°„ì´ ì›ê²© í”„ë¡œì‹œì €, call, send ca ìš”ì²­, ì´ë¼ëŠ” í‚¤ì›Œë“œë¥¼ ì‚¬ìš©í•´ì„œ, ì–´ë–»ê²Œ ì„¤ëª…ë  ìˆ˜ ìˆë‚˜ ? â“â“â“â“â“â“ 

[ìˆ˜ì—… ì¤‘ ì´ëŸ° í•„ê¸°ê°€ ìˆëŠ”ë°, ì™„ì „íˆ ì´í•´ë¥¼ ëª» í•œ ë“¯ í•˜ë‹¤.]
- CA ë¡œ ìš”ì²­ì„ ë³´ë‚´ì„œ, call ì´ë‚˜, send ë¥¼ í†µí•´, ì›ê²© í”„ë¡œì‹œì € ì‹¤í–‰ì„ í•  ìˆ˜ ìˆìŒ.
Â  Â  - â­â­ì§€ê¸ˆì€ ê·¸ê±¸ í•˜ì§€ ì•Šê³ , íŠ¸ëŸ¬í”Œì—ì„œ ì½˜ì†”ë¡œ í™•ì¸í•  ìˆ˜ ìˆìŒ. â­â­
Â  Â  - íŠ¸ëŸ¬í”Œì—ì„œ í•  ìˆ˜ ìˆê²Œ í¸í•˜ê²Œ ë„ì™€ì¤Œ
Â  Â  - truffle ì½˜ì†”ì—ì„œ í™•ì¸í•´ë³´ê³  ì‹¶ì€ë°
```

#### 1) truffle ì½˜ì†” ì‚¬ìš©

```js
// ê¸°ì¡´ì—ëŠ”, js ì—ì„œ ì½”ë“œë¡œ ì‘ì„±í•˜ê³  -> ê°œë°œì ë„êµ¬ë¡œ í™•ì¸í–ˆë˜ ê²ƒ ê°™ì€ë°, ì§€ê¸ˆì€ truffle ì „ìš© ì½˜ì†”ì°½ì„ ì—´ì–´ì„œ ì§„í–‰

// truffle ì½˜ì†” ì‹¤í–‰
	//dj_test í´ë”ì—ì„œ ì§„í–‰
npx truffle console

// truffle ì½˜ì†”ì—ì„œ ì•„ë˜ì™€ ê°™ì´ ì¹œë‹¤ ğŸ‘‡ğŸ‘‡ğŸ‘‡ 
Counter.deployed().then( (instance) => (counter = instance ) );
	// [í•´ì„]
		// Counter 
				// 1) 'solíŒŒì¼ ì‘ì„±' í•  ë•Œ, ê·¸ ì´ë¦„ì´ 'Counter.sol' ì´ì—ˆìŒ. 
			// 2) migrations ì—ì„œ const Counter = artifacts.require("Counter") ì´ë ‡ê²Œ ì»´íŒŒì¼ëœ íŒŒì¼ì„ ê°€ì ¸ì™”ìŒ. (â­â­ ì´ ìˆœê°„, ë°°í¬ë  ì´ë¦„ì´ ê²°ì •ë¨! â­â­â­)
			// 3) ìœ„ì—ì„œ ê²°ì •ëœ ì´ë¦„ìœ¼ë¡œ 'deployer.deploy(Counter)' ì— ì˜í•´ deploy ë¨ 
			// 4) truffle ì½˜ì†”ì—ì„œëŠ”, ìœ„ì™€ ê°™ì´ deploy ëœ ì´ë¦„ì„ ì‚¬ìš©í•¨! ë”°ë¼ì„œ, Counter ê°€ ë¨. 

		// Counter ì‹¤í–‰ì˜ ì˜ë¯¸ â­â­â­
			// ì•„ì§, 'ì´ë”ë¦¬ì›€ ë„¤íŠ¸ì›Œí¬ì— ì˜¬ë¼ê°€ê¸° ì „!' 'Counter ì»¨íŠ¸ë™íŠ¸ì˜ ì •ì˜ ë° êµ¬ì¡°' ë¥¼ ë³¼ ìˆ˜ ìˆìŒ. â­â­â­ 

		// Counter.deployed() ì˜ ì˜ë¯¸ â­â­â­ 
			// 'ì‹¤ì œ ì´ë”ë¦¬ì›€ì— ë°°í¬ëœ Counter ë¥¼ 'ì¸ìŠ¤í„´ìŠ¤' ë¡œ ê°€ì ¸ì˜¨ë‹¤.		

		// Counter.deployed().then( (instance) => (counter = instance ) );
			// ì‹¤ì œ ì´ë”ë¦¬ì›€ì— ë°°í¬ëœ Counter ì»¨íŠ¸ë™íŠ¸ë¥¼ 1) instance ë§¤ê°œë³€ìˆ˜ë¡œ ë°›ê³  2) instance ì— ìˆëŠ” ê²ƒì„ counter ë³€ìˆ˜ì— ë„£ê¸°
		
		// instance ë¥¼ ë°›ì€ counter ë¡œ í•  ìˆ˜ ìˆëŠ” ê²ƒ 
			// 1) ë°°í¬ëœ ìŠ¤ë§ˆíŠ¸ ì»¨íŠ¸ë™íŠ¸(Counter) ì˜ í•˜ìœ„ ìš”ì†Œì¸
			// 2) ë©”ì„œë“œ(sol íŒŒì¼ ì•ˆì— ìˆëŠ” getValue, setValue ë“±) ì— ì ‘ê·¼
			// 3) ì—¬ê¸°ì— call ê³¼ send ê°€ ë“¤ì–´ê°€ ìˆëŠ” ê±´ê°€â“â“â“â“â“ | 'ì—¬ê¸°ì—ëŠ” call ê³¼ send ê°€ ë©”ì„œë“œë¡œ í¬í•¨ë˜ì–´ ìˆìŒ' ì´ë¼ëŠ”ê²Œ ë¬´ìŠ¨ ë§ ì´ì§€â“â“â“ 

// sol íŒŒì¼ì— ê¸°ì¬í•œ í•¨ìˆ˜ì¸ getValue( ) ë¥¼ ì‹¤í–‰í•´ì„œ ê°’ì„ ê°€ì ¸ì˜¤ê¸°
counter.getValue()
	// ê²°ê³¼ : BN { negative: 0, words: [ 0, <1 empty item> ], length: 1, red: null }

// ì•„ë˜ setValue ëŠ” sol íŒŒì¼ì— ì—†ìŒ -> so, ì•„ë˜ì™€ ê°™ì´ ê¸°ì¬í•˜ë©´, ì—ëŸ¬ë‚¨ 
counter.setValue(20)

// counter.increment(1)
counter.increment(1) ğŸ‘‰ counter.getValue() í•˜ë©´, ğŸ‘‰ 'BN { negative: 0, words: [ 1, <1 empty item> ], length: 1, red: null }' ì´ë ‡ê²Œ ê°’ì´ ë‚˜ì™€ ìˆìŒ. 
```

*   truffle ì´ ì‹¤í–‰ë˜ëŠ” ê²½ë¡œ&#x20;

    <figure><img src="https://i.imgur.com/0sXXDTe.png" alt=""><figcaption></figcaption></figure>
*   counter.getValue() ì‹¤í–‰ ê²°ê³¼&#x20;

    <figure><img src="https://i.imgur.com/91bYEtu.png" alt=""><figcaption></figcaption></figure>
* ì•„ë˜ ì„¸ë¶€ ë©”ì†Œë“œ ì •ì˜
  * setValue ì—†ìŒ
  *   increment() ìˆìŒ.&#x20;

      <figure><img src="https://i.imgur.com/DyaWZEJ.png" alt=""><figcaption></figcaption></figure>

\


### 5ï¸âƒ£ í…ŒìŠ¤íŠ¸ ì½”ë“œ ì‘ì„±

#### 1) í…ŒìŠ¤íŠ¸ ì½”ë“œ ì‘ì„±

*   í…ŒìŠ¤íŠ¸ ì½”ë“œ ì‘ì„± ìœ„ì¹˜&#x20;

    <figure><img src="https://i.imgur.com/RtyqrpZ.png" alt=""><figcaption></figcaption></figure>

#### 2) í…ŒìŠ¤íŠ¸ ì½”ë“œ ì‹¤í–‰

```bash
# test í´ë” ì•ˆì— ìˆëŠ”ê²Œ ì•„ë˜ ëª…ë ¹ì–´ë¥¼ ì“°ë©´ ì‹¤í–‰ëœë‹¤. 
	# ì‹¤í–‰ ê²½ë¡œëŠ” dj_test ì•ˆì—ì„œ ì‹¤í–‰í•˜ë©´ ëœë‹¤.
	# truffle console ì´ ì•„ë‹ˆë¼, âœ…ì¼ë°˜ í„°ë¯¸ë„ ì„. 
npx truffle test


```

\


### 6ï¸âƒ£ í…ŒìŠ¤íŠ¸ ì½”ë“œ ì‘ì„±

#### 1) ë°°í¬í•œ ì»¨íŠ¸ë™íŠ¸ ë‚´ìš© ì¡°íšŒ

```js
it( "counter 1" , async () => {
	// ë°°í¬í•œ ì»¨íŠ¸ë™íŠ¸ ë‚´ìš© ì¡°íšŒ
	counter = await Counter.deployed();
		// console.log("ë°°í¬í•œ ì»¨íŠ¸ë™íŠ¸ ë‚´ìš© ì¡°íšŒ" , counter)

		// [í•´ì„] Counter ëŠ” 'ë°°í¬ ë˜ê¸° ì „ êµ¬ì¡° ë° ì •ì˜'
		// Counter.deployed() ëŠ” ë°°í¬ë˜ê³  ë‚œ í›„ ì˜ ë‚´ìš© 
} )
```

\


#### 2) getValue ê°’ ê°€ì ¸ì˜¤ê¸°

```js
[call ì˜ ê¸°ëŠ¥] 
- call ì€ â­â­'ì½ê¸° ì „ìš© í•¨ìˆ˜(í•¨ìˆ˜ì—ì„œ view í˜¹ì€ pure ì ‘ê·¼ìê°€ ë¶™ì€ ê²½ìš°)'â­â­ ì—ì„œ ê°’ì„ ê°€ì ¸ì˜¬ ë•Œ ì‚¬ìš© ëœë‹¤. 

[call ì˜ í•„ìš”ì„±]
- ë¬¼ë¡ , truffle ì—ì„œëŠ” call ì„ ë¶™ì´ì§€ ì•Šì•„ë„, ê°’ì„ ê°€ì ¸ì˜¬ ìˆ˜ ìˆìœ¼ë‚˜ 
	1) ë‹¤ë¥¸ ì‚¬ìš©ìë“¤ì—ê²Œ ëª…ì‹œì ìœ¼ë¡œ 'ê°’ì„ ê°€ì ¸ì˜¤ëŠ” ê±°ì•¼' ë¼ê³  ì•Œë ¤ì¤„ ìˆ˜ ìˆê³  
	2) 'truffle í”„ë ˆì„ì›Œí¬ë¥¼ ì“°ì§€ ì•ŠëŠ”, ë‹¤ë¥¸ í™˜ê²½ì—ì„œ', ê°œë°œí•  ë•Œ, 'í˜¸í™˜' ì´ ì˜ ë  ìˆ˜ ìˆê²Œ í•˜ê¸° ìœ„í•´, call ì„ ì“°ëŠ” ê²½ìš°ê°€ ìˆë‹¤. 

[ì˜ˆë¬¸]
	it( "counter 2" , async() => {
		console.log( "counter 2 - call" , await counter.getValue.call() )  // ğŸ”µ ì‘ë™í•¨
		// console.log( "counter 2 - getValue()" , await counter.getValue() )  // ğŸ”µ ì‘ë™í•¨
	})

```

\


#### 3) setValue ë¡œ ê°’ ë³€ê²½í•˜ê³ , getValue ë¡œ ê°’ ê°€ì ¸ì˜¤ê¸°

```js
// 'setValue' ë¡œ ë³€ê²½(ê°€ìŠ¤ë¹„ ë°œìƒ) í•˜ê³  -> getValue ë¡œ ì¡°íšŒ 
it("counter 3", async () => {
	await counter.setValue(20);
	console.log("setValue(20) ì„¤ì •í•˜ê³  -> getValue ë¡œ ê°€ì ¸ì˜¤ê¸°" , await counter.getValue.call());
});
```

\


### 7ï¸âƒ£ react hook ìœ¼ë¡œ ì¦ê° ë²„íŠ¼ ëˆ„ë¥´ë©´, ìƒíƒœë³€ìˆ˜ ë³€ê²½ ë° ì¡°íšŒ êµ¬í˜„

* CA ì£¼ì†Œ ê°–ê³  ìˆê¸°

```BASH
0x34910676293884d9ca816135cC3a7350c57A1308
```

#### 1) react ê¸°ë³¸ ì„¤ì •

```bash
- ê¸°ë³¸ì ì¸ ë””ë ‰í† ë¦¬ êµ¬ì¡° ë° ì½”ë“œ ì œê±°

- ì´ë²ˆì—ëŠ” App í™”ì‚´í‘œ í•¨ìˆ˜ë¡œ ìš°ì„  ì‹œì‘ 
	const App = () => {   }
```

#### 2) hooks, abi í´ë” ë° íŒŒì¼ ë§Œë“¤ê¸°

```
src í´ë”ì— hooks, abi í´ë” ë§Œë“¤ê¸°
```

![](https://i.imgur.com/Cp7vWCB.png)

#### 3) ì»´íŒŒì¼ ì™„ë£Œëœ Counter.json ì—ì„œ abi í‚¤ì˜ ê°’ë§Œ ê°€ì ¸ì™€ì„œ ë¶™ì—¬ë„£ê¸°

```bash
1) sol íŒŒì¼ë¡œ ì‘ì„± Counter íŒŒì¼ ì‘ì„± 
2) í•´ë‹¹ sol íŒŒì¼ì„ ì»´íŒŒì¼ í•¨. 
3) ì»´íŒŒì¼ ê²°ê³¼ê°€ build í´ë” í•˜ìœ„ì˜ Counter.json ìœ¼ë¡œ ë‚˜ì˜´ 
4) ì´ Counter.json ì—ì„œ abi í‚¤ì— í•´ë‹¹í•˜ëŠ”, [ ] ì´ ë¶€ë¶„ë§Œ ë¹¼ì„œ ê°€ì§€ê³  ì˜¨ë‹¤. 
```

*   abi ê°€ì ¸ì˜¤ê¸°&#x20;

    <figure><img src="https://i.imgur.com/FtZ9hpp.png" alt=""><figcaption></figcaption></figure>
*   ìœ„ì—ì„œ ë§Œë“  src > abi í´ë”ì— ë¶™ì—¬ë„£ê¸°&#x20;

    <figure><img src="https://i.imgur.com/p5wuNcr.png" alt=""><figcaption></figcaption></figure>

\


#### 4) hook ì½”ë“œ ì‘ì„±

```js
import { useState, useEffect } from "react"

import Web3 from 'web3';
    // npm i web3 | â­â­â­ ì´ë ‡ê²Œ ê¹”ë”í•˜ê²Œ ì¨ë†”ë„, ëœë‹¤ 

// Web3 custom hook | âœ… custom hook ì‘ì„±ì‹œ use ë¶™ì—¬ì•¼ í•¨ 
const useWeb3 = () => {

    // í˜„ì¬ ì ‘ì†í•œ ë©”íƒ€ ë§ˆìŠ¤í¬ ì§€ê°‘ ì •ë³´ë¥¼ ë‹´ì„ ë³€ìˆ˜ 
    const [user , setUser] = useState({
        account : "", 
        balance : "",
    })
        // ì§€ê¸ˆ ì ‘ì†ëœ ì§€ê°‘ ì •ë³´ë‘, web3 ì—°ê²°ëœ ê²ƒ! ì„ ê°–ê³  ìˆì„ ê²ƒ ì„. â“â“â“ 
        // ìœ ì €ê°€ ì ‘ì†í•˜ë©´ ì—¬ê¸°ì— ì €ì¥â“â“â“

    // ë„¤íŠ¸ì›Œí¬ì™€ ì—°ê²°í•œ web3 ì¸ìŠ¤í„´ìŠ¤ë¥¼ ë‹´ì„ ë³€ìˆ˜
    const [web3 , setWeb3] = useState(null);

    useEffect( () => {
        // ë©”íƒ€ë§ˆìŠ¤í¬ê°€ ì„¤ì¹˜ ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸í•˜ê¸° | 'window.ethereum' ì•ˆì—, ë„¤íŠ¸ì›Œí¬ ì •ë³´, ì§€ê°‘ë“¤ì´ ë“¤ì–´ê°€ ìˆìŒ -> so, ë©”íƒ€ë§ˆìŠ¤í¬ê°€ ìˆë‹¤ë©´, ë¹ˆ ê°’ì´ ì•„ë‹ ê²ƒ -> so, window.ethereum ìœ¼ë¡œ íŒë³„ ê°€ëŠ¥ 
            if(window.ethereum){

                // ë¡œê·¸ì¸ 
                window.ethereum.request({
                    method : "eth_requestAccounts", 
                })
                    /* - window.ethereum.request 
                            : window.ethereum ê°ì²´ ì•ˆì— ìˆëŠ”, request ë©”ì†Œë“œë¥¼ ì“°ê² ë‹¤ëŠ” ë§ 
                            : 'Ethereum JSON-RPC ë©”ì„œë“œ' ì´ì œ ì“¸ê²Œ~ ë¼ëŠ” ì˜ë¯¸
                        - method : "eth_requestAccounts" 
                            : êµ¬ì²´ì ìœ¼ë¡œ, eth_requestAccounts ì´ë¦„ì˜ ë©”ì„œë“œë¥¼ ì‚¬ìš©í• ê²Œ ë¼ëŠ” ë§
                            : 'ì´ë”ë¦¬ì›€ ë„¤íŠ¸ì›Œí¬' ì•ˆì—ì„œ, 'ì‚¬ìš©ìê°€ ìŠ¹ì¸'í•œ, 'ì§€ê°‘ ì£¼ì†Œë“¤'ì´ ë‚˜ì˜´
                            : EX) ë©”íƒ€ë§ˆìŠ¤í¬ì—ì„œ 'ìŠ¹ì¸' ì„ ëˆŒëŸ¬ì„œ, ë””ì•± ë˜ëŠ” ì›¹ì‚¬ì´íŠ¸ì—, ì´ë”ë¦¬ì›€ ì§€ê°‘ ì£¼ì†Œ ì œê³µì„, í—ˆìš©í•œ ì§€ê°‘ ì£¼ì†Œë“¤ì„ ì˜ë¯¸
                    */
                .then( async ([walletAddress]) => {
                    /* async ([data]) ì¤‘ [data] í•´ì„ 
                        'ë°›ì•„ì˜¨ ë°°ì—´' ì¤‘ 'ì²« ë²ˆì§¸ ìš”ì†Œ' ë¥¼ data ë³€ìˆ˜ ì— í• ë‹¹
                        data ì—ëŠ” 'ì§€ê°‘ ì£¼ì†Œ' ê°€ ë‹´ê²¨ì ¸ ìˆì–´ì•¼ í•¨
                    */

                    // web3 ì¸ìŠ¤í„´ìŠ¤ ìƒì„±
                    const web3Provider = new Web3(window.ethereum);
                        /* [í•´ì„] 
                            web3 ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ í†µí•´, ì´ë”ë¦¬ì›€ ë„¤íŠ¸ì›Œí¬ê³¼ í†µì‹ , ì´ë”ë¦¬ì›€ ë„¤íŠ¸ì›Œí¬ ì•ˆì— ìˆëŠ” ì»¨íŠ¸ë™íŠ¸ì™€ í†µì‹ í•˜ê³ , íŠ¸ëœì­ì…˜ì„ ìƒì„±/ì „ì†¡ í•  ìˆ˜ ìˆìŒ. 
                            web3 ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì—°ê²°í•˜ëŠ” ë°©ë²•ì€ ì—¬ëŸ¬ê°€ì§€ ì„ (ganache ë¡œ í•  ìˆ˜ë„ ìˆê³ , ë¸Œë¼ìš°ì € ì•ˆì— ìˆëŠ” ë©”íƒ€ë§ˆìŠ¤í¬ë¡œ í•  ìˆ˜ë„ ìˆê³ )
                            ê·¸ëŸ¬ë©´, ì§€ê¸ˆì€ 'window.ethereum ì•ˆì— ìˆëŠ” ë©”íƒ€ë§ˆìŠ¤í¬' ë°©ì‹ìœ¼ë¡œ web3 ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì—°ë™ í•œë‹¤ëŠ” ë§ ì„. 
                            ê²°êµ­, 'ë©”íƒ€ë§ˆìŠ¤í¬ë¡œ ì—°ë™ì‹œí‚¨ web3 ë¼ì´ë¸ŒëŸ¬ë¦¬' ë¥¼ í†µí•´ 'ì´ë”ë¦¬ì›€ ë„¤íŠ¸ì›Œí¬' ì™€ 'í†µì‹ ' í•˜ê²Œ ëœë‹¤. â­â­â­ 
                        */
                    
                    // set ë©”ì†Œë“œì— ë„£ì–´ì£¼ê¸° 
                    setWeb3(web3Provider);
                        /* ì´ ìˆœê°„, 'const web3Provider' ì— ë¨¸ë¬´ë¥´ì§€ ì•Šê³ , useState ë¡œ ê´€ë¦¬í•˜ëŠ” ì´ìœ  
                            1) ì»´í¬ë„ŒíŠ¸ ì¬ì‹¤í–‰ì— ë”°ë¼ì„œ -> ë¡œì»¬ ë³€ìˆ˜ê°€ ì´ˆê¸°í™” ë˜ì–´ì„œ -> web3Provider ì— í• ë‹¹ë˜ëŠ” ê°’ì´ ë³€ê²½ë˜ëŠ” ê²ƒì„ ë§‰ê¸° ìœ„í•´
                            2) ì¶”ê°€ì ìœ¼ë¡œ, íŠ¹ì • ë³€ìˆ˜ì˜ ì •ë³´ê°€ ë³€í–ˆì„ ë•Œë§Œ, ì¬ë Œë”ë§ ë˜ê²Œ í•  ìˆ˜ ìˆìŒ.
                        */

                    setUser({
                        // ì§€ê°‘ ì£¼ì†Œê°€ ë‹´ê²¨ ìˆì–´ì•¼ í•¨    
                        account : walletAddress,    // ì§€ê°‘ ì£¼ì†ŒëŠ”, 'privatekey -> ê³µê°œí‚¤ -> 20ë°”ì´íŠ¸' ì˜ ìˆœì„œë¡œ ë§Œë“¤ì–´ì§€ëŠ” ê²ƒ
                        balance : web3Provider.utils.toWei(await web3Provider.eth.getBalance(walletAddress) , "ether")
                            // [í•´ì„] web3 ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ë‹¤ë…€ì˜¬ ë•Œ, await ë¡œ ê¸°ë‹¤ë¦¬ê²Œ í•´ì•¼ í•œë‹¤ëŠ” ê²ƒ â­â­â­
                    });
                })

            } else {
                alert("ë©”íƒ€ ë§ˆìŠ¤í¬! ì„¤ì¹˜! í•˜! ì…ˆ! ğŸ˜¸")
            }
    } , [])

    return {
        user, 
        web3,
    }
}
```

\


#### 5) react app.js ì½”ë“œ ì‘ì„±

**a) ìì£¼ ì˜¤ë¥˜ê°€ ë°œìƒí•˜ëŠ” ë¶€ë¶„**

```bash
- web3 ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ hook ì„ í†µí•´ ê°€ì ¸ì˜¤ê¸° ë•Œë¬¸ì—, user ì •ë³´ ë“±ì´ ë‹¤ ë„ì°© í•  ë•Œ ê¹Œì§€ ê¸°ë‹¤ë¦¬ëŠ” ì²˜ë¦¬ë¥¼ í•´ì¤˜ì•¼ í•¨. ex) ì¡°ê±´ë¶€ ë Œë”ë§, loading ìƒíƒœ ë“± 
```

**b) ì½”ë“œ**

```js
import {useEffect , useState} from 'react';
import useWeb3 from './hooks/web3.hook';
import abi from "./abi/Counter.json"

const App = () => {

  const { user, web3 } = useWeb3();
  const [count , setCount] = useState(0);
  
  // ì´ë”ë¦¬ì›€ ë‚´ì— ìˆëŠ” ìƒíƒœë³€ìˆ˜ ê°’ì„ ê°€ì ¸ì˜¤ê¸° 
    // 1) ìƒíƒœë³€ìˆ˜ë¥¼ ì¡°íšŒí•˜ëŠ” í•¨ìˆ˜ë¥¼ ì¸ì½”ë”© 2) CA ì»¨íŠ¸ë™íŠ¸ ì£¼ì†Œì—, ì¸ì½”ë”©ëœ í•¨ìˆ˜ ë‚´ìš©ì„ ë„£ê³ , 3) ì´ë”ë¦¬ì›€ ë‚´ì—ì„œ ê³„ì‚°í•´ì„œ, 4) ê°’ì„ ë°›ì•„ì˜´
  const getCount = () => {

    if(web3 === null) return;
    
    // customHook ì˜ ë“¤ì–´ì™”ë‚˜ í™•ì¸
    console.log("web3.utils" , web3.utils)  // // hook ì—ì„œ ë§Œë“  ê°’ ë“¤ì–´ì™”ë‚˜ í™•ì¸
    console.log("user" , user)    // hook ì—ì„œ ë§Œë“  ê°’ ë“¤ì–´ì™”ë‚˜ í™•ì¸

    // 'ì»´íŒŒì¼ ëœ ê²°ê³¼ë¬¼ì¸ abi' ì—ì„œ 'getValue' ë©”ì†Œë“œ ê°€ì ¸ì˜¤ê¸° 
    const getValueData = abi.find( (data) => data?.name === "getValue" );
      // ìˆœíšŒí•˜ëŠ” ìš”ì†Œ ê°ì²´ name ì˜ key ê°€ 'getValue' ì¸ì§€ í™•ì¸í•˜ê³  -> ë§ìœ¼ë©´, return 
        // ê·¸ëŸ¬ë©´, ì•„ë˜ì˜ ë‚´ìš©ì´ ë“¤ì–´ê° ğŸ‘‡ğŸ‘‡ 
              /* 
                getValueData = {
                  "inputs": [],
                  "name": "getValue",
                  "outputs": [
                    {
                      "internalType": "uint256",
                      "name": "",
                      "type": "uint256"
                    }
                  ],
                  "stateMutability": "view",
                  "type": "function",
                  "constant": true
                }
              */
                
    // ì“°ê³  ì‹¶ì€ í•¨ìˆ˜ë¥¼ ì¸ì½”ë”© í•˜ê¸°
    const data = web3.eth.abi.encodeFunctionCall(getValueData, []);
      // web3.eth.abi.encodeFunctionCall : ë©”ì†Œë“œë¥¼ ì¸ì½”ë”© í•´ì„œ, ì´ë”ë¦¬ì›€ ë„¤íŠ¸ì›Œí¬ì— ì˜¬ë¦°ë‹¤. 
      // (getValueData, []) : 1) getValueData ì´ê±´, ì´ë”ë¦¬ì›€ ë„¤íŠ¸ì›Œí¬ì— ì˜¬ë¦´ ABI ì •ë³´ 2) [] ì´ê±´, í•´ë‹¹ í•¨ìˆ˜ì— í•„ìš”í•œ ë§¤ê°œë³€ìˆ˜ì¸ë°, ì´ í•¨ìˆ˜ëŠ” ë§¤ê°œë³€ìˆ˜ê°€ í•„ìš” ì—†ìŒ. 
  
    // ì›ê²© í”„ë¡œì‹œì € í˜¸ì¶œ  ğŸ˜¥ğŸ˜¥ğŸ˜¥ 
    web3.eth.call({
      to : "0x3a1904a63b22D74BFaE32Bb982295Bff599BFEDa",  // âœ… npx truffle migrate ë¡œ ë‚˜ì˜¤ëŠ” ca ê°’ ì…ë ¥
      data    // ì“°ê³  ì‹¶ì€ ë©”ì†Œë“œ âœ… ì—¬ê¸°ë¡œ getValue í•¨ìˆ˜ê°€ ë“¤ì–´ê°. 
    })  
    .then( (data) => {
      console.log(data)   // 16ì§„ìˆ˜ë¡œ ë‚˜ì˜¤ê³  ìˆìŒ. 

      // 16ì§„ìˆ˜ -> 10ì§„ìˆ˜ ë¡œ ë³€ê²½
      const result = parseInt(data , 16);   
      console.log(result);

      // ì¹´ìš´íŠ¸ ë“±ë¡
      setCount(Number(result));
    })
        /* ì›ê²© í”„ë¡œì‹œì €ë¥¼ í˜¸ì¶œí•œë‹¤ëŠ” ê²Œ ë¬´ìŠ¨ ì˜ë¯¸ì§€? | ğŸ˜¥ğŸ˜¥ğŸ˜¥ğŸ˜¥ğŸ˜¥ğŸ˜¥ ì´ ìˆœê°„ ì´í•´ê°€ 100% ì•ˆ ë¼  
          ì´ë ‡ê²Œ í˜¸ì¶œí•˜ë©´ -> ì´ë”ë¦¬ì›€ ë„¤íŠ¸ì›Œí¬ì—ì„œ, ì´ë¯¸ ë°°í¬ëœ sol íŒŒì¼ ì•ˆì— ìˆëŠ” ë©”ì†Œë“œì— ì ‘ê·¼í•´ì„œ, -> í•´ë‹¹ íŒŒì¼ ì•ˆì— ìˆëŠ” ë©”ì†Œë“œë¥¼ ì‹¤í–‰ì‹œí‚¤ê³  -> ê²°ê³¼ê°’ì„ ë°˜í™˜ì‹œí‚¨ë‹¤.
        */
  }
  // ìƒíƒœë³€ê²½ í•¨ìˆ˜ : increment
  const increment = async() => {
    console.log("ì¦ê°€ ì°í˜")    
    if(user && user.account){
      // abi ì—ì„œ name ì´ increment ì¸ ë©”ì†Œë“œë¥¼ ê°€ì ¸ì™€ì„œ incrementData ì— ë‹´ê¸°
      const incrementData = abi.find( (data) => data.name === 'increment' );
  
      // abi ê°ì²´ë¥¼, ì´ë”ë¦¬ì›€ ë„¤íŠ¸ì›Œí¬ì— ì˜¬ë¦´ ìˆ˜ ìˆê²Œ, ì¸ì½”ë”© í•´ì„œ data ë³€ìˆ˜ì— ë‹´ê¸° 
      const encodedData = web3.eth.abi.encodeFunctionCall(incrementData, []);

      const fromUserAccount = user.account;
      console.log("user.account" , user.account)
      console.log("user.account" , fromUserAccount)
      
      const _data = await web3.eth.sendTransaction({
        from : fromUserAccount, 
        to : "0x3a1904a63b22D74BFaE32Bb982295Bff599BFEDa",  // âœ… npx truffle migrate ë¡œ ë‚˜ì˜¤ëŠ” ca ê°’ ì…ë ¥
        data : encodedData    
      })

      console.log(_data)
      getCount()
    }
      /* sendTransaction ì´ê±°ë‘ send ë‘ ë‹¤ë¥¸ ì ì´ ë­ì˜€ì§€â“â“â“  */
      /* ë­˜ ë³€ê²½í•´ì¤˜! ë¼ëŠ” ë§ì´ ì•ˆ ì í˜€ ìˆëŠ”ë°, ì–´ë–»ê²Œ ëœê±°ì§€â“â“â“ 
        ğŸ‘‰ ì•„, ì´ê±´, ì´ë¯¸ solidity ì— ì í˜€ ìˆì–´ì„œ, ì´ë¯¸ ë°˜ì˜ ë˜ì—ˆì„ ê²ƒ. 
      */
  }

  // ìƒíƒœë³€ê²½ í•¨ìˆ˜ : decrement
  const decrement = async() => {

    console.log("ê°ì†Œ ì°í˜")
    
    if(user && user.account){
      // abi ì—ì„œ name ì´ increment ì¸ ë©”ì†Œë“œë¥¼ ê°€ì ¸ì™€ì„œ incrementData ì— ë‹´ê¸°
      const decrementData = abi.find( (data) => data.name === 'decrement' );
  
      // abi ê°ì²´ë¥¼, ì´ë”ë¦¬ì›€ ë„¤íŠ¸ì›Œí¬ì— ì˜¬ë¦´ ìˆ˜ ìˆê²Œ, ì¸ì½”ë”© í•´ì„œ data ë³€ìˆ˜ì— ë‹´ê¸° 
      const encodedData = web3.eth.abi.encodeFunctionCall(decrementData, []);

      const fromUserAccount = user.account;
      console.log("user.account" , user.account)
      console.log("user.account" , fromUserAccount)
      
      const _data = await web3.eth.sendTransaction({
        from : fromUserAccount, 
        to : "0x3a1904a63b22D74BFaE32Bb982295Bff599BFEDa",  // âœ… npx truffle migrate ë¡œ ë‚˜ì˜¤ëŠ” ca ê°’ ì…ë ¥
        data : encodedData    
      })

      console.log(_data)
      getCount()
    }
  }

  useEffect( () => {
    // ìµœì´ˆê°’ ì¡°íšŒ
    if( web3 !== null ) getCount(); 
  } , [web3]);

  return (
    <>
      {/* í˜„ì¬ ë©”íƒ€ë§ˆìŠ¤í¬ì— ë¡œê·¸ì¸í•œ ìœ ì €ì˜ ì§€ê°‘ ì£¼ì†Œ */}
      <p> ì§€ê°‘ ì£¼ì†Œ : {user.account} </p>   

      <p> ì¹´ìš´íŠ¸ : {count} </p>
      <button onClick={increment} > ì¦ê°€ </button>
      <button onClick={decrement} > ê°ì†Œ </button>
    </>
  )
}
export default App;
```

### 8ï¸âƒ£ ì‹¤í–‰í•´ë³´ê¸° | #checksheet

```bash
# npx truffle migrate -> CA ê°’ ê¸°ì–µí•˜ê¸°
0x469FbC41736952356A81f6B9F9d65248204CE2E3

# ì»´íŒŒì¼ 
npx truffle compile 

# ì»´íŒŒì¼ ëœ ì½”ë“œë¥¼ src>abi ì— ì˜®ê¸°ê¸° 
- ì˜®ê¸°ê¸°

# ê°€ë‚˜ì‰¬ ì‹¤í–‰
npx ganache-cli

# ì´ë”ë¦¬ì›€ ë„¤íŠ¸ì›Œí¬ ë°°í¬
npx truffle migrate


```

### ğŸ¤¯ ë””ë²„ê¹…

#### ë¬¸ì œ ìƒí™©

```
account ë¥¼ ë„£ìœ¼ë©´ ì‘ë™í•˜ëŠ”ë° 
contract address ë¥¼ ë„£ìœ¼ë©´ ì‘ë™ì„ ì•ˆ í•´ ğŸ˜¥ğŸ˜¥ğŸ˜¥ 
```

![](https://i.imgur.com/Jnewql2.png)

**ì²œì²œíˆ ì²˜ë¦¬ ê³¼ì • ë”°ë¼ê°€ ë³´ê¸° : step by step ì½ì–´ë³´ê¸°**

* user.account ê¹Œì§€ëŠ” ì°í˜ ![](https://i.imgur.com/89LwjzY.png)
* ì•„... ì´ ë¶€ë¶„ì„ data ì— ë„˜ê²¨ì£¼ëŠ” ê°’ì„, encodedData ë³€ìˆ˜ë¡œ ë³€ê²½í–ˆëŠ”ë°, ê·¸ëŸ¬ë ¤ë©´, data key ë¥¼ ìœ ì§€í•˜ê³  ìˆì—ˆì–´ì•¼ í–ˆìŒ â­â­â­ ![](https://i.imgur.com/hLev6HQ.png)

### ğŸ”® ê¶ê¸ˆì¦

```
- í˜„ì¬ ë„¤íŠ¸ì›Œí¬ì— ìˆëŠ” ê³„ì •ì„ ì°ì–´ë³´ë‹ˆê¹Œ, ë‚´ê°€ í•˜ì§€ ì•Šì€ ê³„ì •ë“¤ ê¹Œì§€ ë‚˜ì˜´. 
- ì´ê±´, ì˜ˆì „ì— í–ˆë˜ ê³„ì •ì„ ì´ê³³ì— ê·¸ëƒ¥, ë†“ì•„ë‘”ê±°ì•¼? 
```

![](https://i.imgur.com/a2FK45d.png)

\


```bash
npx truffle migrate í•˜ë©´, ì•„ë˜ ì •ë³´ë“¤ì´ ë‚˜ì˜¤ëŠ”ë° 
account ë‘ 
contract address ê°€ ì–´ë–¤ ì°¨ì´? 

- account : ì§€ê°‘ ì£¼ì†Œ (ê°œì¸í‚¤ -> ê³µê°œí‚¤ -> ì¼ì • ìë¦¬ë§Œ ë½‘ì•„ì„œ ë§Œë“  ì£¼ì†Œ)
- contract address : í•´ë‹¹ 'ì»¨íŠ¸ë™íŠ¸'ê°€, ì´ë”ë¦¬ì›€ ë„¤íŠ¸ì›Œí¬ì— 'ë°°í¬'ë  ë•Œ, 'ìƒì„±ë˜ëŠ” ì£¼ì†Œ'  
```

![](https://i.imgur.com/ksW6cA3.png)
